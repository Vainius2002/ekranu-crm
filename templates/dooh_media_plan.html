{% extends "base.html" %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1>Media Planas</h1>
        <p class="text-muted">{{ plan.name }} ({{ plan.start_date.strftime('%Y-%m-%d') }} - {{ plan.end_date.strftime('%Y-%m-%d') }})</p>
    </div>
    <div>
        <button class="btn btn-info me-2" onclick="calculateTotals()">
            <i class="fas fa-calculator me-2"></i>Perskaičiuoti
        </button>
        <a href="{{ url_for('dooh_plan_screens', id=plan.id) }}" class="btn btn-warning">
            <i class="fas fa-tv me-2"></i>Valdyti Ekranus
        </a>
        <a href="{{ url_for('dooh_plan_detail', id=plan.id) }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-2"></i>Grįžti
        </a>
    </div>
</div>

<!-- Media Plan Information Header -->
<div class="card mb-4">
    <div class="card-body">
        <div class="text-center">
            <h6 class="text-muted mb-1">Ekranų skaičius</h6>
            <span class="text-warning fs-4 fw-bold">{{ plan.screen_bookings|length }}</span>
        </div>
    </div>
</div>

{% if not plan.screen_bookings %}
<div class="alert alert-warning">
    <i class="fas fa-exclamation-triangle me-2"></i>
    <strong>Nėra pasirinktų ekranų!</strong> 
    <a href="{{ url_for('dooh_plan_screens', id=plan.id) }}" class="alert-link">Pirmiausia pasirinkite ekranus</a>.
</div>
{% else %}

<!-- Calendar Selector -->
<div class="card mb-4">
    <div class="card-header bg-primary text-white">
        <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0"><i class="fas fa-calendar me-2"></i>Pasirinkite Savaitę</h5>
            <div>
                <button class="btn btn-light btn-sm" onclick="previousWeek()">
                    <i class="fas fa-chevron-left"></i> Ankstesnė
                </button>
                <button class="btn btn-light btn-sm" onclick="nextWeek()">
                    Kita <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
    <div class="card-body">
        <!-- Selected Week Date Display -->
        <div class="text-center mb-4">
            <div id="selectedWeekRange" class="text-primary fw-bold fs-3 mb-4">
                {{ plan.start_date.strftime('%Y-%m-%d') }} - {{ (plan.start_date + timedelta(days=6)).strftime('%Y-%m-%d') }}
            </div>
        </div>
        
        <!-- TV-Planning Style Calendar -->
        <div class="tv-planning-calendar mx-auto" style="max-width: 1000px;">
            <table class="table table-bordered table-sm mb-0 planning-calendar-table">
                <thead>
                    <tr class="bg-primary text-white">
                        <th class="text-center" style="width: 14.28%;">Pr</th>
                        <th class="text-center" style="width: 14.28%;">An</th>
                        <th class="text-center" style="width: 14.28%;">Tr</th>
                        <th class="text-center" style="width: 14.28%;">Kt</th>
                        <th class="text-center" style="width: 14.28%;">Pn</th>
                        <th class="text-center" style="width: 14.28%;">Št</th>
                        <th class="text-center" style="width: 14.28%;">Sk</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="calendar-dates-row" id="calendarDatesRow">
                        <!-- Calendar dates will be populated by JavaScript -->
                    </tr>
                    <tr class="cpt-totals-row bg-success text-white">
                        <td class="text-center font-weight-bold" id="mondayTotal">0.00€</td>
                        <td class="text-center font-weight-bold" id="tuesdayTotal">0.00€</td>
                        <td class="text-center font-weight-bold" id="wednesdayTotal">0.00€</td>
                        <td class="text-center font-weight-bold" id="thursdayTotal">0.00€</td>
                        <td class="text-center font-weight-bold" id="fridayTotal">0.00€</td>
                        <td class="text-center font-weight-bold" id="saturdayTotal">0.00€</td>
                        <td class="text-center font-weight-bold" id="sundayTotal">0.00€</td>
                    </tr>
                </tbody>
            </table>
        </div>
        </div>
    </div>
</div>

<!-- New Week Calendar (Initially Hidden) -->
<div class="card mb-4" id="newWeekCalendarCard" style="display: none;">
    <div class="card-header bg-success text-white">
        <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0"><i class="fas fa-calendar-plus me-2"></i>Sukurti Naują Savaitę</h5>
            <button class="btn btn-light btn-sm" onclick="cancelNewWeek()">
                <i class="fas fa-times"></i> Atšaukti
            </button>
        </div>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-8">
                <!-- New Week Calendar Grid -->
                <div class="calendar-grid">
                    <div class="calendar-header">
                        <div class="calendar-month" id="newWeekCurrentMonth">
                            {{ plan.start_date.strftime('%Y %B') }}
                        </div>
                    </div>
                    <div class="calendar-weekdays">
                        <div class="weekday">Pr</div>
                        <div class="weekday">An</div>
                        <div class="weekday">Tr</div>
                        <div class="weekday">Kt</div>
                        <div class="weekday">Pn</div>
                        <div class="weekday">Št</div>
                        <div class="weekday">Sk</div>
                    </div>
                    <div class="calendar-dates" id="newWeekCalendarDates">
                        <!-- Calendar dates will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="new-week-info">
                    <div id="newWeekRange" class="text-success fw-bold fs-5 mb-3">
                        Pasirinkite savaitę...
                    </div>
                    <div class="mb-3">
                        <label for="newWeekName" class="form-label">Naujos savaitės pavadinimas:</label>
                        <input type="text" id="newWeekName" class="form-control mb-2" placeholder="pvz. Savaitė 2">
                        <button class="btn btn-success w-100" onclick="confirmCreateNewWeek()" disabled id="confirmNewWeekBtn">
                            <i class="fas fa-save me-2"></i>Sukurti savaitę
                        </button>
                    </div>
                    <div class="mt-2">
                        <small class="text-muted">
                            Nauja savaitė bus sukurta pagal pasirinktą datų intervalą
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Media planning grid -->
{% for booking in plan.screen_bookings %}
<div class="card mb-4 screen-planning-card">
    <div class="card-header">
        <div class="row align-items-center">
            <div class="col-md-6">
                <h5 class="mb-0">
                    <i class="fas fa-tv me-2"></i>{{ booking.screen.name }}
                </h5>
                <small class="text-muted">{{ booking.screen.city }} - {{ booking.screen.provider.name }}</small>
            </div>
            <div class="col-md-6 text-end">
                <span class="badge bg-info me-2">CPT: <span class="cpt-value">0.00</span>€</span>
                <span class="badge bg-secondary me-2">
                    Klipo trukmė: 
                    <input type="number" class="clip-duration-input" value="15" min="1" max="60" style="width: 35px; border: none; background: transparent; color: white; text-align: center;">s
                </span>
                <button class="btn btn-sm btn-outline-secondary" onclick="copyToAllDays({{ booking.id }})">
                    <i class="fas fa-copy me-1"></i>Kopijuoti į visas dienas
                </button>
            </div>
        </div>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-bordered table-sm mb-0 media-planning-table">
                <thead>
                    <tr class="bg-primary text-white">
                        <th class="text-center" style="min-width: 100px;">Laikas</th>
                        <th class="text-center" style="min-width: 80px;">Kartai</th>
                        <th class="text-center" style="min-width: 80px;">Suma</th>
                        <th class="text-center" style="min-width: 80px;">Kartai</th>
                        <th class="text-center" style="min-width: 80px;">Suma</th>
                        <th class="text-center" style="min-width: 80px;">VISO</th>
                    </tr>
                </thead>
                <tbody>
                    {% for hour in range(6, 24) %}
                    <tr class="time-row-{{ hour }}">
                        <td class="text-center align-middle bg-light">
                            <strong>{{ "%02d"|format(hour) }}.00-{{ "%02d"|format(hour + 1) }}.00</strong>
                        </td>
                        <!-- First kartai column -->
                        <td class="text-center p-1">
                            <input type="number" 
                                   class="form-control form-control-sm kartai-input text-center" 
                                   min="0" max="999" 
                                   value="0"
                                   data-booking="{{ booking.id }}"
                                   data-hour="{{ hour }}"
                                   data-row="1"
                                   onchange="calculateTotals()"
                                   style="width: 60px;">
                        </td>
                        <!-- First suma column -->
                        <td class="text-center p-1 bg-light">
                            <span class="suma-display small text-muted" id="suma_{{ booking.id }}_{{ hour }}_1">0.00€</span>
                        </td>
                        <!-- Second kartai column -->
                        <td class="text-center p-1">
                            <input type="number" 
                                   class="form-control form-control-sm kartai-input text-center" 
                                   min="0" max="999" 
                                   value="0"
                                   data-booking="{{ booking.id }}"
                                   data-hour="{{ hour }}"
                                   data-row="2"
                                   onchange="calculateTotals()"
                                   style="width: 60px;">
                        </td>
                        <!-- Second suma column -->
                        <td class="text-center p-1 bg-light">
                            <span class="suma-display small text-muted" id="suma_{{ booking.id }}_{{ hour }}_2">0.00€</span>
                        </td>
                        <!-- Hour total column -->
                        <td class="text-center align-middle bg-warning">
                            <strong class="hour-grand-total" data-hour="{{ hour }}">0</strong>
                        </td>
                    </tr>
                    {% endfor %}
                    
                    <!-- Grand total row -->
                    <tr class="bg-success fw-bold text-white">
                        <td class="text-center align-middle">
                        </td>
                        <td class="text-center align-middle">
                            <div class="mb-1"><small>VISO</small></div>
                            <strong class="row-total-1">0</strong>
                        </td>
                        <td class="text-center align-middle">
                            <div class="mb-1"><small>€</small></div>
                            <strong class="suma-total-1">0.00€</strong>
                        </td>
                        <td class="text-center align-middle">
                            <div class="mb-1"><small>VISO</small></div>
                            <strong class="row-total-2">0</strong>
                        </td>
                        <td class="text-center align-middle">
                            <div class="mb-1"><small>€</small></div>
                            <strong class="suma-total-2">0.00€</strong>
                        </td>
                        <td class="text-center align-middle">
                            <div class="mb-1"><small>BENDRAI</small></div>
                            <strong class="screen-grand-total">0.00€</strong>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endfor %}

<!-- Total summary -->
<div class="card mt-4">
    <div class="card-body">
        <div class="row text-center">
            <div class="col-md-4">
                <h3 class="text-primary mb-0" id="totalSlots">0</h3>
                <p class="mb-0">Iš viso transliacijų</p>
            </div>
            <div class="col-md-4">
                <h3 class="text-success mb-0" id="totalCost">0.00€</h3>
                <p class="mb-0">Bendra kaina</p>
            </div>
            <div class="col-md-4">
                <h3 class="text-info mb-0" id="avgCPT">0.00€</h3>
                <p class="mb-0">Vidutinis CPT</p>
            </div>
        </div>
    </div>
</div>

{% endif %}

<script>
// Global variables
let currentWeekStart = new Date('{{ plan.start_date.strftime('%Y-%m-%d') }}');
const planStartDate = new Date('{{ plan.start_date.strftime('%Y-%m-%d') }}');
const planEndDate = new Date('{{ plan.end_date.strftime('%Y-%m-%d') }}');

// Calendar functions
function initializeCalendar() {
    generateCalendar();
    updateSelectedWeekRange();
}

function generateCalendar() {
    const calendarDatesRow = document.getElementById('calendarDatesRow');
    
    // Clear previous dates
    calendarDatesRow.innerHTML = '';
    
    const monthNames = ['Sausis', 'Vasaris', 'Kovas', 'Balandis', 'Gegužė', 'Birželis', 'Liepa', 'Rugpjūtis', 'Rugsėjis', 'Spalis', 'Lapkritis', 'Gruodis'];
    
    // Generate current week (7 days)
    for (let day = 0; day < 7; day++) {
        const date = new Date(currentWeekStart);
        date.setDate(currentWeekStart.getDate() + day);
        
        const dayCell = document.createElement('td');
        dayCell.className = 'calendar-day-cell text-center';
        
        // Create day structure similar to TV planning
        dayCell.innerHTML = `
            <div class="date-number">${date.getDate()}</div>
            <div class="cpt-value" id="cpt_day_${day}">0.00€</div>
        `;
        
        // Add classes based on date status
        if (date < planStartDate || date > planEndDate) {
            dayCell.classList.add('disabled');
        }
        
        calendarDatesRow.appendChild(dayCell);
    }
}

function isDateInCurrentWeek(date) {
    const weekEnd = new Date(currentWeekStart);
    weekEnd.setDate(weekEnd.getDate() + 6);
    return date >= currentWeekStart && date <= weekEnd;
}

function selectWeekFromDate(date) {
    // Get Monday of the week containing this date
    const dayOfWeek = date.getDay();
    const mondayOffset = dayOfWeek === 0 ? -6 : 1 - dayOfWeek; // Handle Sunday
    currentWeekStart = new Date(date);
    currentWeekStart.setDate(date.getDate() + mondayOffset);
    
    generateCalendar();
    updateSelectedWeekRange();
}

function updateSelectedWeekRange() {
    const weekEnd = new Date(currentWeekStart);
    weekEnd.setDate(weekEnd.getDate() + 6);
    
    const formatDate = (date) => {
        return date.getFullYear() + '-' + 
               String(date.getMonth() + 1).padStart(2, '0') + '-' + 
               String(date.getDate()).padStart(2, '0');
    };
    
    const rangeText = formatDate(currentWeekStart) + ' - ' + formatDate(weekEnd);
    document.getElementById('selectedWeekRange').textContent = rangeText;
}

function previousWeek() {
    const newWeekStart = new Date(currentWeekStart);
    newWeekStart.setDate(newWeekStart.getDate() - 7);
    
    if (newWeekStart >= planStartDate) {
        currentWeekStart = newWeekStart;
        generateCalendar();
        updateSelectedWeekRange();
    }
}

function nextWeek() {
    const newWeekStart = new Date(currentWeekStart);
    newWeekStart.setDate(newWeekStart.getDate() + 7);
    
    if (newWeekStart <= planEndDate) {
        currentWeekStart = newWeekStart;
        generateCalendar();
        updateSelectedWeekRange();
    }
}

function calculateTotals() {
    let dailyTotals = [0, 0, 0, 0, 0, 0, 0]; // 7 days of the week
    
    document.querySelectorAll('.screen-planning-card').forEach(card => {
        const bookingId = card.querySelector('.kartai-input').dataset.booking;
        
        // Calculate totals for each row
        for (let row = 1; row <= 2; row++) {
            let rowTotal = 0;
            let rowCost = 0;
            
            // Sum kartai for this row
            card.querySelectorAll(`.kartai-input[data-row="${row}"]`).forEach(input => {
                const kartai = parseInt(input.value || 0);
                rowTotal += kartai;
                
                // Calculate cost (assuming 5€ per broadcast)
                const cost = kartai * 5.0;
                rowCost += cost;
                
                // Update individual suma display
                const hour = input.dataset.hour;
                const sumaElement = document.getElementById(`suma_${bookingId}_${hour}_${row}`);
                if (sumaElement) {
                    sumaElement.textContent = cost.toFixed(2) + '€';
                }
            });
            
            // Update row totals
            card.querySelector(`.row-total-${row}`).textContent = rowTotal;
            card.querySelector(`.suma-total-${row}`).textContent = rowCost.toFixed(2) + '€';
        }
        
        // Calculate grand totals for each hour
        for (let hour = 6; hour < 24; hour++) {
            let hourGrandTotal = 0;
            card.querySelectorAll(`.kartai-input[data-hour="${hour}"]`).forEach(input => {
                hourGrandTotal += parseInt(input.value || 0);
            });
            
            const hourTotalElement = card.querySelector(`.hour-grand-total[data-hour="${hour}"]`);
            if (hourTotalElement) {
                hourTotalElement.textContent = hourGrandTotal;
            }
            
            // Add to daily totals (distribute across 7 days - simplified approach)
            const dayIndex = hour % 7;
            dailyTotals[dayIndex] += hourGrandTotal * 5.0; // 5€ per broadcast
        }
        
        // Calculate screen grand total
        const row1Total = parseFloat(card.querySelector('.suma-total-1').textContent.replace('€', '') || 0);
        const row2Total = parseFloat(card.querySelector('.suma-total-2').textContent.replace('€', '') || 0);
        const screenGrandTotal = row1Total + row2Total;
        
        card.querySelector('.screen-grand-total').textContent = screenGrandTotal.toFixed(2) + '€';
    });
    
    // Update calendar CPT displays
    updateCalendarCPT(dailyTotals);
    
    // Calculate overall totals
    let totalSlots = 0;
    let totalCost = 0;
    
    document.querySelectorAll('.screen-grand-total').forEach(total => {
        const cost = parseFloat(total.textContent.replace('€', '') || 0);
        totalCost += cost;
    });
    
    document.querySelectorAll('.kartai-input').forEach(input => {
        totalSlots += parseInt(input.value || 0);
    });
    
    document.getElementById('totalSlots').textContent = totalSlots;
    document.getElementById('totalCost').textContent = totalCost.toFixed(2) + '€';
    
    const avgCPT = totalSlots > 0 ? (totalCost * 1000) / totalSlots : 0;
    document.getElementById('avgCPT').textContent = avgCPT.toFixed(2) + '€';
}

function updateCalendarCPT(dailyTotals) {
    // Update calendar day displays
    for (let day = 0; day < 7; day++) {
        const cptElement = document.getElementById(`cpt_day_${day}`);
        if (cptElement) {
            cptElement.textContent = dailyTotals[day].toFixed(2) + '€';
        }
    }
    
    // Update total row
    const dayIds = ['mondayTotal', 'tuesdayTotal', 'wednesdayTotal', 'thursdayTotal', 'fridayTotal', 'saturdayTotal', 'sundayTotal'];
    for (let day = 0; day < 7; day++) {
        const totalElement = document.getElementById(dayIds[day]);
        if (totalElement) {
            totalElement.textContent = dailyTotals[day].toFixed(2) + '€';
        }
    }
}

function loadSelectedWeek() {
    alert('Pasirinktos savaitės duomenų įkėlimas - funkcionalumas bus pridėtas vėliau');
}

// New week creation functions
let newWeekStart = null;

function createNewWeek() {
    const newWeekCard = document.getElementById('newWeekCalendarCard');
    newWeekCard.style.display = 'block';
    
    // Initialize new week calendar
    generateNewWeekCalendar();
    
    // Scroll to new week calendar
    newWeekCard.scrollIntoView({ behavior: 'smooth' });
}

function cancelNewWeek() {
    const newWeekCard = document.getElementById('newWeekCalendarCard');
    newWeekCard.style.display = 'none';
    
    // Reset values
    newWeekStart = null;
    document.getElementById('newWeekName').value = '';
    document.getElementById('newWeekRange').textContent = 'Pasirinkite savaitę...';
    document.getElementById('confirmNewWeekBtn').disabled = true;
}

function generateNewWeekCalendar() {
    const calendarDates = document.getElementById('newWeekCalendarDates');
    const currentMonth = document.getElementById('newWeekCurrentMonth');
    
    const year = planStartDate.getFullYear();
    const month = planStartDate.getMonth();
    
    currentMonth.textContent = new Date(year, month).toLocaleDateString('lt-LT', { year: 'numeric', month: 'long' });
    
    // Clear previous dates
    calendarDates.innerHTML = '';
    
    // Get first day of month and number of days
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const startDate = new Date(firstDay);
    startDate.setDate(startDate.getDate() - firstDay.getDay() + 1); // Start from Monday
    
    // Generate 6 weeks of calendar
    for (let week = 0; week < 6; week++) {
        for (let day = 0; day < 7; day++) {
            const date = new Date(startDate);
            date.setDate(startDate.getDate() + week * 7 + day);
            
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-date new-week-calendar-date';
            dayElement.textContent = date.getDate();
            
            // Add classes based on date status
            if (date.getMonth() !== month) {
                dayElement.classList.add('other-month');
            }
            if (date < planStartDate || date > planEndDate) {
                dayElement.classList.add('disabled');
            } else {
                dayElement.addEventListener('click', () => selectNewWeekFromDate(date));
            }
            
            // Highlight selected week
            if (newWeekStart && isDateInNewWeek(date)) {
                dayElement.classList.add('selected-week');
            }
            
            calendarDates.appendChild(dayElement);
        }
    }
}

function isDateInNewWeek(date) {
    if (!newWeekStart) return false;
    const weekEnd = new Date(newWeekStart);
    weekEnd.setDate(weekEnd.getDate() + 6);
    return date >= newWeekStart && date <= weekEnd;
}

function selectNewWeekFromDate(date) {
    // Get Monday of the week containing this date
    const dayOfWeek = date.getDay();
    const mondayOffset = dayOfWeek === 0 ? -6 : 1 - dayOfWeek; // Handle Sunday
    newWeekStart = new Date(date);
    newWeekStart.setDate(date.getDate() + mondayOffset);
    
    generateNewWeekCalendar();
    updateNewWeekRange();
    
    // Enable confirm button
    document.getElementById('confirmNewWeekBtn').disabled = false;
}

function updateNewWeekRange() {
    if (!newWeekStart) return;
    
    const weekEnd = new Date(newWeekStart);
    weekEnd.setDate(weekEnd.getDate() + 6);
    
    const formatDate = (date) => {
        return date.getFullYear() + '-' + 
               String(date.getMonth() + 1).padStart(2, '0') + '-' + 
               String(date.getDate()).padStart(2, '0');
    };
    
    const rangeText = formatDate(newWeekStart) + ' - ' + formatDate(weekEnd);
    document.getElementById('newWeekRange').textContent = rangeText;
}

function confirmCreateNewWeek() {
    const weekName = document.getElementById('newWeekName').value.trim();
    if (!weekName) {
        alert('Prašome įvesti savaitės pavadinimą');
        return;
    }
    
    if (!newWeekStart) {
        alert('Prašome pasirinkti savaitę kalendoriuje');
        return;
    }
    
    // Here you would typically make an API call to create the new week
    // For now, just show a success message
    const weekEnd = new Date(newWeekStart);
    weekEnd.setDate(weekEnd.getDate() + 6);
    
    const formatDate = (date) => {
        return date.getFullYear() + '-' + 
               String(date.getMonth() + 1).padStart(2, '0') + '-' + 
               String(date.getDate()).padStart(2, '0');
    };
    
    const weekRange = formatDate(newWeekStart) + ' - ' + formatDate(weekEnd);
    
    alert(`Nauja savaitė "${weekName}" (${weekRange}) bus sukurta!`);
    
    // Hide the new week calendar
    cancelNewWeek();
}


// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    initializeCalendar();
    calculateTotals();
});
</script>

<style>
/* TV-Planning Style Calendar */
.tv-planning-calendar {
    max-width: 100%;
}

.planning-calendar-table {
    border: 2px solid #007bff;
    font-size: 0.9rem;
}

.planning-calendar-table th {
    background-color: #007bff !important;
    color: white;
    font-weight: bold;
    padding: 0.75rem 0.5rem;
    border: 1px solid #0056b3;
    font-size: 0.9rem;
}

.calendar-day-cell {
    background-color: #fff;
    padding: 1rem 0.5rem;
    border: 1px solid #dee2e6;
    vertical-align: middle;
    min-height: 80px;
}

.calendar-day-cell.disabled {
    background-color: #f8f9fa;
    color: #6c757d;
}

.date-number {
    font-size: 1.5rem;
    font-weight: bold;
    color: #007bff;
    margin-bottom: 0.25rem;
}

.date-month {
    font-size: 0.7rem;
    color: #6c757d;
    text-transform: uppercase;
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.cpt-value {
    font-size: 0.85rem;
    font-weight: bold;
    color: #28a745;
    background-color: #f8f9fa;
    padding: 0.25rem 0.5rem;
    border: 1px solid #dee2e6;
    border-radius: 0.25rem;
    display: inline-block;
    min-width: 60px;
}

.cpt-totals-row {
    background-color: #28a745 !important;
}

.cpt-totals-row td {
    padding: 0.75rem 0.5rem;
    font-size: 1rem;
    font-weight: bold;
    border: 1px solid #1e7e34;
}

.calendar-date:hover:not(.disabled) {
    background-color: #e3f2fd;
}

.calendar-date.selected-week {
    background-color: #007bff;
    color: white;
    font-weight: bold;
}

.calendar-date.other-month {
    color: #adb5bd;
    background-color: #f8f9fa;
}

.calendar-date.disabled {
    background-color: #f8f9fa;
    color: #6c757d;
    cursor: not-allowed;
}

.selected-week-info {
    background-color: #f8f9fa;
    padding: 1rem;
    border-radius: 0.375rem;
    border: 1px solid #dee2e6;
}

.new-week-info {
    background-color: #f0f8f0;
    padding: 1rem;
    border-radius: 0.375rem;
    border: 1px solid #d4edda;
}

/* New week calendar specific styles */
.new-week-calendar-date:hover:not(.disabled) {
    background-color: #d4edda;
}

.new-week-calendar-date.selected-week {
    background-color: #28a745;
    color: white;
    font-weight: bold;
}

/* Animation for new week calendar */
#newWeekCalendarCard {
    animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Media Planning Table Styles */
.media-planning-table {
    font-size: 0.75rem;
    margin-bottom: 0;
}

.media-planning-table th {
    background-color: #007bff;
    color: white;
    font-weight: 600;
    text-align: center;
    vertical-align: middle;
    border: 1px solid #0056b3;
    padding: 0.25rem;
}

.media-planning-table td {
    padding: 0.2rem;
    vertical-align: middle;
    border: 1px solid #dee2e6;
}

.kartai-input {
    border: 1px solid #ced4da;
    padding: 2px 4px;
    font-size: 0.7rem;
    text-align: center;
    width: 100%;
    max-width: 45px;
}

.kartai-input:focus {
    border-color: #007bff;
    box-shadow: 0 0 0 0.1rem rgba(0, 123, 255, 0.25);
}

.suma-display {
    font-size: 0.65rem;
    color: #28a745;
    font-weight: 500;
}

.screen-planning-card {
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Row alternating colors */
.kartai-row-1 {
    background-color: #ffffff;
}

.suma-row-1 {
    background-color: #f8f9fa !important;
}

.kartai-row-2 {
    background-color: #ffffff;
}

.suma-row-2 {
    background-color: #f8f9fa !important;
}

/* Responsive design */
@media (max-width: 768px) {
    .calendar-grid {
        font-size: 0.8rem;
    }
    
    .media-planning-table {
        font-size: 0.65rem;
    }
    
    .kartai-input {
        width: 35px;
        font-size: 0.6rem;
    }
}
</style>
{% endblock %}